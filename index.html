<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– ì±—ë´‡ ìì—°ì–´ ì˜¤ë‹µë¥  ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script>
        // ChartDataLabels í”ŒëŸ¬ê·¸ì¸ ì „ì—­ ë“±ë¡ í™•ì¸
        if (typeof Chart !== 'undefined' && typeof ChartDataLabels !== 'undefined') {
            Chart.register(ChartDataLabels);
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
        }

        .main-content {
            margin-left: 320px;
        }

        .sidebar {
            position: fixed;
            left: 20px;
            top: 20px;
            width: 280px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            z-index: 200;
            scrollbar-width: thin;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(102, 126, 234, 0.3);
            border-radius: 10px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(102, 126, 234, 0.5);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 20px;
            margin-bottom: 40px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
        }

        .sidebar-panel {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .sidebar-panel h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.2rem;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 15px;
            font-weight: 600;
        }

        .game-tabs {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .game-tabs li {
            margin-bottom: 8px;
        }

        .game-tabs a {
            color: #555;
            text-decoration: none;
            padding: 12px 15px;
            display: block;
            border-radius: 8px;
            transition: all 0.2s;
            font-size: 0.95rem;
            border-left: 3px solid transparent;
        }

        .game-tabs a:hover {
            background: #f8f9fa;
            color: #667eea;
            border-left-color: #667eea;
        }

        .game-tabs a.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-left-color: #667eea;
        }

        .section {
            background: white;
            padding: 40px 50px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            display: none;
        }

        .section.active {
            display: block;
        }

        .section h2 {
            color: #667eea;
            font-size: 1.8rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .metric-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .metric-card .number {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .game-metric-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .game-metric-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s;
            cursor: pointer;
        }

        .game-metric-card:hover {
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .game-name {
            font-size: 1rem;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 12px;
            text-align: center;
        }

        .game-metric-row {
            display: flex;
            justify-content: space-around;
            gap: 10px;
        }

        .game-metric-item {
            flex: 1;
            text-align: center;
        }

        .game-label {
            font-size: 0.75rem;
            color: #666;
            margin-bottom: 5px;
        }

        .game-number {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
        }

        .metric-card .label {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 0;
            border: none;
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            max-height: 85vh;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            padding: 20px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
        }

        .modal-close {
            color: white;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .modal-close:hover,
        .modal-close:focus {
            opacity: 0.7;
        }

        .modal-body {
            padding: 20px 30px;
            overflow-y: auto;
            flex: 1;
        }

        .error-item-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }

        .error-item-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .error-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e9ecef;
        }

        .error-item-number {
            font-weight: 600;
            color: #667eea;
            font-size: 0.9rem;
        }

        .error-item-category {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            background: #f8d7da;
            color: #721c24;
        }

        .error-item-question {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .error-item-answer {
            color: #666;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .error-item-date {
            font-size: 0.85rem;
            color: #999;
        }

        .chart-container {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin: 20px 0;
            position: relative;
            height: 400px;
        }

        .upload-section {
            background: #e8f4f8;
            border-left: 4px solid #667eea;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .upload-section h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            display: block;
            padding: 15px 20px;
            background: white;
            border: 2px dashed #667eea;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-input-label:hover {
            background: #f8f9fa;
            border-color: #764ba2;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .data-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-badge.correct {
            background: #d4edda;
            color: #155724;
        }

        .status-badge.error {
            background: #f8d7da;
            color: #721c24;
        }

        .error-type-select {
            padding: 6px 12px;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.9rem;
            width: 100%;
        }

        @media (max-width: 1400px) {
            .main-content {
                margin-left: 0;
            }
            
            .sidebar {
                position: relative;
                left: auto;
                top: auto;
                width: 100%;
                max-height: none;
                margin-bottom: 30px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ì‚¬ì´ë“œë°” -->
        <div class="sidebar">
            <div class="sidebar-panel">
                <h3>ğŸ® ê²Œì„ ì„ íƒ</h3>
                <ul class="game-tabs">
                    <li><a href="#" class="tab-link" data-tab="overview">ğŸ“‹ ë¬¸ì„œ ê°œìš”</a></li>
                    <li><a href="#" class="tab-link active" data-tab="dashboard">ğŸ“Š ëŒ€ì‹œë³´ë“œ</a></li>
                    <li><a href="#" class="tab-link" data-tab="newmago">ë‰´ë§ê³ </a></li>
                    <li><a href="#" class="tab-link" data-tab="sutda">ì„¯ë‹¤</a></li>
                    <li><a href="#" class="tab-link" data-tab="poker">í¬ì»¤</a></li>
                    <li><a href="#" class="tab-link" data-tab="newvegas">ë‰´ë² ê°€ìŠ¤</a></li>
                    <li><a href="#" class="tab-link" data-tab="showdown">ì‡¼ë‹¤ìš´í™€ë¤</a></li>
                    <li><a href="#" class="tab-link" data-tab="pc-integrated">PC í†µí•© ì±—ë´‡</a></li>
                </ul>
            </div>
        </div>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <div class="main-content">
            <div class="header">
                <h1>ğŸ¤– ì±—ë´‡ ìì—°ì–´ ì˜¤ë‹µë¥  ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h1>
                <p>ê²Œì„ë³„ ì±—ë´‡ ì˜¤ë‹µë¥  í†µê³„ ë° ë¶„ì„</p>
            </div>

            <!-- ë¬¸ì„œ ê°œìš” ì„¹ì…˜ -->
            <section id="overview" class="section">
                <h2>ğŸ“‹ ë¬¸ì„œ ê°œìš”</h2>
                
                <div class="document-overview" style="background: white; padding: 25px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <strong style="color: #764ba2;">ì‘ì„±ì</strong>
                            <p style="margin: 5px 0; color: #555;">ì´ì¬ì°¬(ê³ ê°ì§€ì›íŒ€)</p>
                        </div>
                        <div>
                            <strong style="color: #764ba2;">ì‘ì„±ì¼ì‹œ</strong>
                            <p style="margin: 5px 0; color: #555;">2025. 11. 27.</p>
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <strong style="color: #764ba2; display: block; margin-bottom: 8px;">ëª©ì </strong>
                        <p style="color: #555; line-height: 1.8; margin: 0;">
                            ë‰´ë§ê³ , ì„¯ë‹¤, í¬ì»¤, ë‰´ë² ê°€ìŠ¤, ì‡¼ë‹¤ìš´í™€ë¤, PC í†µí•© ì±—ë´‡ ë“± 6ê°œ ê²Œì„ì˜ ì±—ë´‡ ìì—°ì–´ ì§ˆë¬¸-ë‹µë³€ ë°ì´í„°ë¥¼ CSV íŒŒì¼ë¡œ ì—…ë¡œë“œí•˜ì—¬, 
                            ì •ë‹µ ì—¬ë¶€(O/X) ë° ë¶„ë¥˜ ìœ í˜•ì„ ìˆ˜ë™ìœ¼ë¡œ í‰ê°€í•˜ê³ , ì „ì²´ ì˜¤ë‹µë¥  ë° ì˜¤ë‹µ ìœ í˜•ë³„ í™•ë¥ ì„ ìë™ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ” ëŒ€ì‹œë³´ë“œë¥¼ ì œê³µí•¨.
                            <br><br>
                            ê¸°ì¡´ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ìˆ˜ë™ ë¶„ì„ ë°©ì‹ì„ ëŒ€ì²´í•˜ì—¬, ë°ì´í„° ì—…ë¡œë“œ ì¦‰ì‹œ í†µê³„ ë¶„ì„ ë° ì‹œê°í™”ë¥¼ ì œê³µí•˜ê³ , 
                            LocalStorageë¥¼ í†µí•œ ë°ì´í„° ìë™ ì €ì¥ìœ¼ë¡œ ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ í‰ê°€ ë°ì´í„°ê°€ ìœ ì§€ë˜ë„ë¡ í•¨.
                        </p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <strong style="color: #764ba2; display: block; margin-bottom: 8px;">í‰ê°€ ê¸°ì¤€ ë° ë¶„ë¥˜ ì²´ê³„</strong>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea;">
                            <div style="margin-bottom: 20px;">
                                <h4 style="color: #28a745; margin-bottom: 10px; font-size: 1.1rem;">âœ… ì •ë‹µ (Pass)</h4>
                                <ul style="color: #555; line-height: 1.8; margin: 0; padding-left: 20px;">
                                    <li><strong>ì •ìƒ ë‹µë³€:</strong> ë‹µë³€ì´ ì •í™•í•˜ê³  ì ì ˆí•¨</li>
                                    <li><strong>ë°ì´í„° ë¶€ì¡± (ì •ìƒ):</strong> ëª¨ë¥´ëŠ” ê²ƒì„ ëª¨ë¥¸ë‹¤ê³  ì •í™•íˆ ë‹µë³€í•¨</li>
                                    <li><strong>ê²Œì„ ì™¸ ì§ˆë¬¸ (ì •ìƒ):</strong> ì¼ìƒ ëŒ€í™” ë“±ì— ì ì ˆíˆ ëŒ€ì‘í•¨</li>
                                </ul>
                            </div>
                            <div>
                                <h4 style="color: #dc3545; margin-bottom: 10px; font-size: 1.1rem;">âŒ ì˜¤ë‹µ (Fail)</h4>
                                <ul style="color: #555; line-height: 1.8; margin: 0; padding-left: 20px;">
                                    <li><strong>ì‚¬ì‹¤ ê´€ê³„ ì˜¤ë¥˜:</strong> ì—†ëŠ” ê¸°ëŠ¥ì„ ìˆë‹¤ê³  í•˜ê±°ë‚˜ í‹€ë¦° ì •ë³´ ì œê³µ (ì˜ˆ: ê´‘ê³  ì œê±° ê°€ëŠ¥í•˜ë‹¤ê³  ì˜ëª» ë‹µë³€)</li>
                                    <li><strong>ì˜ë„ íŒŒì•… ì‹¤íŒ¨:</strong> Aë¥¼ ë¬¼ì—ˆëŠ”ë° Bì— ëŒ€í•´ ë‹µë³€ (ì˜ˆ: íƒˆí‡´ ë¬¸ì˜ â†’ ê²°ì œ ì•ˆë‚´)</li>
                                    <li><strong>ë™ë¬¸ì„œë‹µ/TMI:</strong> ë¶ˆí•„ìš”í•œ ì •ë³´ ë‚˜ì—´, ì§ˆë¬¸ í•µì‹¬ê³¼ ë¬´ê´€í•œ ë‚´ìš©</li>
                                    <li><strong>ë‹µë³€ ë¶ˆì™„ì „:</strong> êµ¬ì²´ì ì´ì§€ ì•Šê³  ëª¨í˜¸í•œ ë‹µë³€</li>
                                    <li><strong>ê¸°íƒ€:</strong> ìœ„ í•­ëª©ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ì˜¤ë‹µ</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <strong style="color: #764ba2; display: block; margin-bottom: 8px;">íš¨ê³¼</strong>
                        <ul style="color: #555; line-height: 1.8; margin: 0; padding-left: 20px;">
                            <li><strong>ë¶„ì„ íš¨ìœ¨ì„± í–¥ìƒ:</strong> CSV íŒŒì¼ ì—…ë¡œë“œ ì¦‰ì‹œ ì§ˆë¬¸-ë‹µë³€ ë°ì´í„°ë¥¼ í…Œì´ë¸”ë¡œ í‘œì‹œí•˜ê³ , ì •ë‹µ ì—¬ë¶€ ì²´í¬ ë° ì˜¤ë‹µ ìœ í˜• ë¶„ë¥˜ë¥¼ ì§ê´€ì ìœ¼ë¡œ ìˆ˜í–‰ ê°€ëŠ¥.</li>
                            <li><strong>ì‹¤ì‹œê°„ í†µê³„ ê³„ì‚°:</strong> ì •ë‹µ ì—¬ë¶€(O/X) ì…ë ¥ ì‹œ ìë™ìœ¼ë¡œ ì˜¤ë‹µë¥ , ì˜¤ë‹µ ìœ í˜•ë³„ í™•ë¥ ì„ ê³„ì‚°í•˜ì—¬ ì¦‰ì‹œ í™•ì¸ ê°€ëŠ¥.</li>
                            <li><strong>ë°ì´í„° ì˜êµ¬ ë³´ì¡´:</strong> LocalStorageë¥¼ í†µí•œ ìë™ ì €ì¥ìœ¼ë¡œ ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ í‰ê°€ ë°ì´í„° ë° í†µê³„ê°€ ìœ ì§€ë¨.</li>
                            <li><strong>ê²Œì„ë³„ ë¶„ë¦¬ ê´€ë¦¬:</strong> 6ê°œ ê²Œì„ë³„ë¡œ ë…ë¦½ì ì¸ íƒ­ì„ ì œê³µí•˜ì—¬ ê²Œì„ë³„ ì˜¤ë‹µë¥ ì„ ê°œë³„ì ìœ¼ë¡œ ë¶„ì„ ë° ë¹„êµ ê°€ëŠ¥.</li>
                            <li><strong>ì‹œê°í™” ì œê³µ:</strong> ì¼ìë³„/ì›”ë³„ ì˜¤ë‹µë¥  ì¶”ì´, ê²Œì„ë³„ ì˜¤ë‹µë¥  ë¹„êµ, ì˜¤ë‹µ ìœ í˜•ë³„ ë¶„í¬ ì°¨íŠ¸ë¥¼ í†µí•œ ì§ê´€ì ì¸ ë°ì´í„° ë¶„ì„.</li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <strong style="color: #764ba2; display: block; margin-bottom: 8px;">ì£¼ìš” ì‘ì—… ë‚´ì—­</strong>
                        <ul style="color: #555; line-height: 1.8; margin: 0; padding-left: 20px;">
                            <li>CSV/ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ êµ¬í˜„ (PapaParse, SheetJS ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©)</li>
                            <li>ê²Œì„ë³„ ë°ì´í„° íƒ­ ë¶„ë¦¬ (ë‰´ë§ê³ , ì„¯ë‹¤, í¬ì»¤, ë‰´ë² ê°€ìŠ¤, ì‡¼ë‹¤ìš´í™€ë¤, PC í†µí•© ì±—ë´‡)</li>
                            <li>ì •ë‹µ ì—¬ë¶€(O/X) ë“œë¡­ë‹¤ìš´ ì„ íƒ ê¸°ëŠ¥ ë° ì˜¤ë‹µ ìœ í˜• ë¶„ë¥˜ ê¸°ëŠ¥ êµ¬í˜„</li>
                            <li>ì‹¤ì‹œê°„ ì˜¤ë‹µë¥  ê³„ì‚° ë° í†µê³„ í‘œì‹œ (ì§ˆë¬¸ ìˆ˜, ì˜¤ë‹µ ìˆ˜, ì˜¤ë‹µë¥ )</li>
                            <li>LocalStorageë¥¼ í†µí•œ ë°ì´í„° ìë™ ì €ì¥ ë° ë³µì› ê¸°ëŠ¥</li>
                            <li>ë‚ ì§œ í˜•ì‹ ë³€í™˜ (AnswerTime â†’ YYMMDD í˜•ì‹)</li>
                            <li>ëŒ€ì‹œë³´ë“œ í†µí•© í†µê³„ ë° ì°¨íŠ¸ ì‹œê°í™” (Chart.js í™œìš©)</li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <strong style="color: #764ba2; display: block; margin-bottom: 8px;">í˜„ì¬ ìƒíƒœ ë° ë‹¤ìŒ ë‹¨ê³„</strong>
                        <ul style="color: #555; line-height: 1.8; margin: 0; padding-left: 20px;">
                            <li><strong>í˜„ì¬ ìƒíƒœ:</strong> CSV/ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ, ì •ë‹µ ì—¬ë¶€ í‰ê°€, ì˜¤ë‹µ ìœ í˜• ë¶„ë¥˜, ê¸°ë³¸ í†µê³„ ê³„ì‚° ê¸°ëŠ¥ ì™„ë£Œ</li>
                            <li><strong>ë‹¤ìŒ ë‹¨ê³„:</strong> ì¼ìë³„/ì›”ë³„ ì˜¤ë‹µë¥  ì¶”ì´ ì°¨íŠ¸ ê°œì„ , ë°ì´í„° ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥(CSV/Excel), í•„í„°ë§/ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€</li>
                        </ul>
                    </div>

                    <div>
                        <strong style="color: #764ba2; display: block; margin-bottom: 15px;">ğŸ’¡ ê°œì„  íš¨ê³¼</strong>
                        <table style="width: 100%; border-collapse: collapse; background: #f8f9fa; border-radius: 8px; overflow: hidden;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; text-align: left; font-weight: 600;">í•­ëª©</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600;">ê¸°ì¡´ ë°©ì‹ (ìˆ˜ì‘ì—…)</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600;">ìë™í™” ì‹œìŠ¤í…œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid #e9ecef;">
                                    <td style="padding: 12px; font-weight: 600; color: #667eea;">ë°ì´í„° ì—…ë¡œë“œ</td>
                                    <td style="padding: 12px; color: #555;">êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì— ìˆ˜ë™ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°</td>
                                    <td style="padding: 12px; color: #28a745; font-weight: 600;">CSV/ì—‘ì…€ íŒŒì¼ ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ì¦‰ì‹œ ì—…ë¡œë“œ</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e9ecef; background: white;">
                                    <td style="padding: 12px; font-weight: 600; color: #667eea;">ì •ë‹µ ì—¬ë¶€ í‰ê°€</td>
                                    <td style="padding: 12px; color: #555;">ìˆ˜ë™ìœ¼ë¡œ O/X ì…ë ¥ (ì˜¤íƒ€ ìœ„í—˜)</td>
                                    <td style="padding: 12px; color: #28a745; font-weight: 600;">ë“œë¡­ë‹¤ìš´ ì„ íƒìœ¼ë¡œ ì˜¤íƒ€ ë°©ì§€</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e9ecef;">
                                    <td style="padding: 12px; font-weight: 600; color: #667eea;">ì˜¤ë‹µë¥  ê³„ì‚°</td>
                                    <td style="padding: 12px; color: #555;">ìˆ˜ì‹ ìˆ˜ë™ ì…ë ¥ ë° ê²€ìˆ˜ í•„ìš”</td>
                                    <td style="padding: 12px; color: #28a745; font-weight: 600;">ì‹¤ì‹œê°„ ìë™ ê³„ì‚° ë° í‘œì‹œ</td>
                                </tr>
                                <tr style="border-bottom: 1px solid #e9ecef; background: white;">
                                    <td style="padding: 12px; font-weight: 600; color: #667eea;">ë°ì´í„° ë³´ì¡´</td>
                                    <td style="padding: 12px; color: #555;">ìƒˆë¡œê³ ì¹¨ ì‹œ ë°ì´í„° ì†ì‹¤</td>
                                    <td style="padding: 12px; color: #28a745; font-weight: 600;">LocalStorage ìë™ ì €ì¥ìœ¼ë¡œ ì˜êµ¬ ë³´ì¡´</td>
                                </tr>
                                <tr style="background: white;">
                                    <td style="padding: 12px; font-weight: 600; color: #667eea;">ì†Œìš” ì‹œê°„</td>
                                    <td style="padding: 12px; color: #555;">íŒŒì¼ ì¤€ë¹„ + ìˆ˜ì‹ ì…ë ¥ + ê²€ìˆ˜: 10~30ë¶„</td>
                                    <td style="padding: 12px; color: #28a745; font-weight: 600;">íŒŒì¼ ì—…ë¡œë“œ: 1ì´ˆ ë‚´ ì™„ë£Œ</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ëŒ€ì‹œë³´ë“œ ì„¹ì…˜ -->
            <section id="dashboard" class="section active">
                <h2>ğŸ“Š ì „ì²´ ì˜¤ë‹µë¥  ëŒ€ì‹œë³´ë“œ</h2>
                
                <div class="metric-cards">
                    <div class="metric-card">
                        <div class="label">ì „ì²´ ì˜¤ë‹µë¥ </div>
                        <div class="number" id="overall-error-rate">-</div>
                        <div class="label">ì „ì²´ ì§ˆë¬¸ ëŒ€ë¹„</div>
                    </div>
                    <div class="metric-card">
                        <div class="label">ì´ ì§ˆë¬¸ ìˆ˜</div>
                        <div class="number" id="total-questions">-</div>
                        <div class="label">ëˆ„ì  ì§ˆë¬¸</div>
                    </div>
                    <div class="metric-card">
                        <div class="label">ì´ ì˜¤ë‹µ ìˆ˜</div>
                        <div class="number" id="total-errors">-</div>
                        <div class="label">ì˜¤ë‹µ ë°œìƒ</div>
                    </div>
                </div>

                <h3 style="color: #764ba2; margin: 30px 0 15px 0;">ğŸ® ê²Œì„ë³„ í†µê³„</h3>
                <div class="game-metric-cards">
                    <div class="game-metric-card" data-game-id="newmago" onclick="showErrorItems('newmago', 'ğŸ´ ë‰´ë§ê³ ')">
                        <div class="game-name">ğŸ´ ë‰´ë§ê³ </div>
                        <div class="game-metric-row">
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µë¥ </div>
                                <div class="game-number" id="game-newmago-error-rate">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="game-number" id="game-newmago-total">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="game-number" id="game-newmago-errors">-</div>
                            </div>
                        </div>
                    </div>
                    <div class="game-metric-card" data-game-id="sutda" onclick="showErrorItems('sutda', 'ğŸƒ ì„¯ë‹¤')">
                        <div class="game-name">ğŸƒ ì„¯ë‹¤</div>
                        <div class="game-metric-row">
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µë¥ </div>
                                <div class="game-number" id="game-sutda-error-rate">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="game-number" id="game-sutda-total">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="game-number" id="game-sutda-errors">-</div>
                            </div>
                        </div>
                    </div>
                    <div class="game-metric-card" data-game-id="poker" onclick="showErrorItems('poker', 'ğŸ‚¡ í¬ì»¤')">
                        <div class="game-name">ğŸ‚¡ í¬ì»¤</div>
                        <div class="game-metric-row">
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µë¥ </div>
                                <div class="game-number" id="game-poker-error-rate">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="game-number" id="game-poker-total">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="game-number" id="game-poker-errors">-</div>
                            </div>
                        </div>
                    </div>
                    <div class="game-metric-card" data-game-id="newvegas" onclick="showErrorItems('newvegas', 'ğŸ° ë‰´ë² ê°€ìŠ¤')">
                        <div class="game-name">ğŸ° ë‰´ë² ê°€ìŠ¤</div>
                        <div class="game-metric-row">
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µë¥ </div>
                                <div class="game-number" id="game-newvegas-error-rate">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="game-number" id="game-newvegas-total">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="game-number" id="game-newvegas-errors">-</div>
                            </div>
                        </div>
                    </div>
                    <div class="game-metric-card" data-game-id="showdown" onclick="showErrorItems('showdown', 'ğŸ¯ ì‡¼ë‹¤ìš´í™€ë¤')">
                        <div class="game-name">ğŸ¯ ì‡¼ë‹¤ìš´í™€ë¤</div>
                        <div class="game-metric-row">
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µë¥ </div>
                                <div class="game-number" id="game-showdown-error-rate">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="game-number" id="game-showdown-total">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="game-number" id="game-showdown-errors">-</div>
                            </div>
                        </div>
                    </div>
                    <div class="game-metric-card" data-game-id="pc-integrated" onclick="showErrorItems('pc-integrated', 'ğŸ’» PC í†µí•© ì±—ë´‡')">
                        <div class="game-name">ğŸ’» PC í†µí•© ì±—ë´‡</div>
                        <div class="game-metric-row">
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µë¥ </div>
                                <div class="game-number" id="game-pc-integrated-error-rate">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="game-number" id="game-pc-integrated-total">-</div>
                            </div>
                            <div class="game-metric-item">
                                <div class="game-label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="game-number" id="game-pc-integrated-errors">-</div>
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="color: #764ba2; margin: 30px 0 15px 0;">ğŸ“… ì›”ë³„ ì˜¤ë‹µë¥  ì¶”ì´</h3>
                <div class="chart-container">
                    <canvas id="monthly-chart"></canvas>
                </div>

                <h3 style="color: #764ba2; margin: 30px 0 15px 0;">ğŸ“Š ì˜¤ë‹µ ìœ í˜•ë³„ ë¶„í¬</h3>
                <div class="chart-container">
                    <canvas id="error-type-chart"></canvas>
                </div>

                <h3 style="color: #764ba2; margin: 30px 0 15px 0;">ğŸ® ê²Œì„ë³„ ì˜¤ë‹µë¥  ë¹„êµ</h3>
                <div class="chart-container">
                    <canvas id="game-comparison-chart"></canvas>
                </div>

                <h3 style="color: #764ba2; margin: 30px 0 15px 0;">ğŸ“ˆ ì¼ìë³„ ì˜¤ë‹µë¥  ì¶”ì´</h3>
                <div class="chart-container">
                    <canvas id="daily-chart"></canvas>
                </div>
            </section>

            <!-- ê²Œì„ë³„ ì„¹ì…˜ë“¤ -->
            <section id="newmago" class="section">
                <h2>ğŸ´ ë‰´ë§ê³  ì˜¤ë‹µë¥  ë¶„ì„</h2>
                <div id="newmago-content">
                    <div class="upload-section">
                        <h3>ğŸ“ CSV íŒŒì¼ ì—…ë¡œë“œ</h3>
                        <div class="file-input-wrapper">
                            <input type="file" id="newmago-file" accept=".csv" onchange="handleFileUpload('newmago', this)">
                            <label for="newmago-file" class="file-input-label">
                                ğŸ“„ CSV íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”
                            </label>
                        </div>
                    </div>
                    <div id="newmago-stats" style="display: none;">
                        <div class="metric-cards">
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µë¥ </div>
                                <div class="number" id="newmago-error-rate">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="number" id="newmago-total">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="number" id="newmago-errors">-</div>
                            </div>
                        </div>
                        <div id="newmago-table-container"></div>
                    </div>
                </div>
            </section>

            <section id="sutda" class="section">
                <h2>ğŸƒ ì„¯ë‹¤ ì˜¤ë‹µë¥  ë¶„ì„</h2>
                <div id="sutda-content">
                    <div class="upload-section">
                        <h3>ğŸ“ CSV íŒŒì¼ ì—…ë¡œë“œ</h3>
                        <div class="file-input-wrapper">
                            <input type="file" id="sutda-file" accept=".csv" onchange="handleFileUpload('sutda', this)">
                            <label for="sutda-file" class="file-input-label">
                                ğŸ“„ CSV íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”
                            </label>
                        </div>
                    </div>
                    <div id="sutda-stats" style="display: none;">
                        <div class="metric-cards">
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µë¥ </div>
                                <div class="number" id="sutda-error-rate">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="number" id="sutda-total">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="number" id="sutda-errors">-</div>
                            </div>
                        </div>
                        <div id="sutda-table-container"></div>
                    </div>
                </div>
            </section>

            <section id="poker" class="section">
                <h2>ğŸƒ í¬ì»¤ ì˜¤ë‹µë¥  ë¶„ì„</h2>
                <div id="poker-content">
                    <div class="upload-section">
                        <h3>ğŸ“ CSV íŒŒì¼ ì—…ë¡œë“œ</h3>
                        <div class="file-input-wrapper">
                            <input type="file" id="poker-file" accept=".csv" onchange="handleFileUpload('poker', this)">
                            <label for="poker-file" class="file-input-label">
                                ğŸ“„ CSV íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”
                            </label>
                        </div>
                    </div>
                    <div id="poker-stats" style="display: none;">
                        <div class="metric-cards">
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µë¥ </div>
                                <div class="number" id="poker-error-rate">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="number" id="poker-total">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="number" id="poker-errors">-</div>
                            </div>
                        </div>
                        <div id="poker-table-container"></div>
                    </div>
                </div>
            </section>

            <section id="newvegas" class="section">
                <h2>ğŸ° ë‰´ë² ê°€ìŠ¤ ì˜¤ë‹µë¥  ë¶„ì„</h2>
                <div id="newvegas-content">
                    <div class="upload-section">
                        <h3>ğŸ“ CSV íŒŒì¼ ì—…ë¡œë“œ</h3>
                        <div class="file-input-wrapper">
                            <input type="file" id="newvegas-file" accept=".csv" onchange="handleFileUpload('newvegas', this)">
                            <label for="newvegas-file" class="file-input-label">
                                ğŸ“„ CSV íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”
                            </label>
                        </div>
                    </div>
                    <div id="newvegas-stats" style="display: none;">
                        <div class="metric-cards">
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µë¥ </div>
                                <div class="number" id="newvegas-error-rate">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="number" id="newvegas-total">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="number" id="newvegas-errors">-</div>
                            </div>
                        </div>
                        <div id="newvegas-table-container"></div>
                    </div>
                </div>
            </section>

            <section id="showdown" class="section">
                <h2>ğŸ¯ ì‡¼ë‹¤ìš´í™€ë¤ ì˜¤ë‹µë¥  ë¶„ì„</h2>
                <div id="showdown-content">
                    <div class="upload-section">
                        <h3>ğŸ“ CSV íŒŒì¼ ì—…ë¡œë“œ</h3>
                        <div class="file-input-wrapper">
                            <input type="file" id="showdown-file" accept=".csv" onchange="handleFileUpload('showdown', this)">
                            <label for="showdown-file" class="file-input-label">
                                ğŸ“„ CSV íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”
                            </label>
                        </div>
                    </div>
                    <div id="showdown-stats" style="display: none;">
                        <div class="metric-cards">
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µë¥ </div>
                                <div class="number" id="showdown-error-rate">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="number" id="showdown-total">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="number" id="showdown-errors">-</div>
                            </div>
                        </div>
                        <div id="showdown-table-container"></div>
                    </div>
                </div>
            </section>

            <section id="pc-integrated" class="section">
                <h2>ğŸ’» PC í†µí•© ì±—ë´‡ ì˜¤ë‹µë¥  ë¶„ì„</h2>
                <div id="pc-integrated-content">
                    <div class="upload-section">
                        <h3>ğŸ“ CSV íŒŒì¼ ì—…ë¡œë“œ</h3>
                        <div class="file-input-wrapper">
                            <input type="file" id="pc-integrated-file" accept=".csv" onchange="handleFileUpload('pc-integrated', this)">
                            <label for="pc-integrated-file" class="file-input-label">
                                ğŸ“„ CSV íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œí•˜ì„¸ìš”
                            </label>
                        </div>
                    </div>
                    <div id="pc-integrated-stats" style="display: none;">
                        <div class="metric-cards">
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µë¥ </div>
                                <div class="number" id="pc-integrated-error-rate">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì§ˆë¬¸ ìˆ˜</div>
                                <div class="number" id="pc-integrated-total">-</div>
                            </div>
                            <div class="metric-card">
                                <div class="label">ì˜¤ë‹µ ìˆ˜</div>
                                <div class="number" id="pc-integrated-errors">-</div>
                            </div>
                        </div>
                        <div id="pc-integrated-table-container"></div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- ê²Œì„ë³„ ì˜¤ë‹µ í•­ëª© ëª¨ë‹¬ -->
    <div id="error-items-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-game-name">ê²Œì„ ì˜¤ë‹µ í•­ëª©</h2>
                <span class="modal-close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="error-items-list" style="max-height: 70vh; overflow-y: auto;">
                    <!-- ì˜¤ë‹µ í•­ëª© ë¦¬ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë°ì´í„° ì €ì¥
        const gameData = {
            'newmago': null,
            'sutda': null,
            'poker': null,
            'newvegas': null,
            'showdown': null,
            'pc-integrated': null
        };

        // íƒ­ ì „í™˜
        document.querySelectorAll('.tab-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const tabId = this.getAttribute('data-tab');
                
                // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
                document.querySelectorAll('.tab-link').forEach(l => l.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                
                // ì„ íƒëœ íƒ­ í™œì„±í™”
                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
                
                // ëŒ€ì‹œë³´ë“œë©´ í†µê³„ ì—…ë°ì´íŠ¸
                if (tabId === 'dashboard') {
                    updateDashboard();
                }
            });
        });

        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ (CSV ë° ì—‘ì…€ ì§€ì›)
        function handleFileUpload(gameId, input) {
            const file = input.files[0];
            if (!file) return;

            const fileName = file.name.toLowerCase();
            const isExcelByExtension = fileName.endsWith('.xlsx') || fileName.endsWith('.xls');
            
            // íŒŒì¼ ë‚´ìš©ìœ¼ë¡œ ì‹¤ì œ í˜•ì‹ ê°ì§€ (í™•ì¥ìë§Œìœ¼ë¡œ íŒë‹¨í•˜ì§€ ì•ŠìŒ)
            const reader = new FileReader();
            reader.onload = function(e) {
                const arrayBuffer = e.target.result;
                const uint8Array = new Uint8Array(arrayBuffer);
                
                // ì—‘ì…€ íŒŒì¼ì€ ZIP í˜•ì‹ìœ¼ë¡œ PK(0x50 0x4B)ë¡œ ì‹œì‘
                const isExcelByContent = uint8Array.length >= 2 && 
                                         uint8Array[0] === 0x50 && 
                                         uint8Array[1] === 0x4B;
                
                // í™•ì¥ìì™€ ë‚´ìš© ëª¨ë‘ í™•ì¸
                const isExcel = isExcelByExtension || isExcelByContent;
                
                if (isExcel) {
                    // ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬
                    processExcelFile(gameId, arrayBuffer);
                } else {
                    // CSV íŒŒì¼ ì²˜ë¦¬
                    const text = new TextDecoder('UTF-8').decode(uint8Array);
                    processCSVFile(gameId, text);
                }
            };
            
            // ArrayBufferë¡œ ì½ì–´ì„œ íŒŒì¼ í˜•ì‹ í™•ì¸
            reader.readAsArrayBuffer(file);
        }
        
        // ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ í•¨ìˆ˜
        function processExcelFile(gameId, arrayBuffer) {
            try {
                const data = new Uint8Array(arrayBuffer);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                
                // JSONìœ¼ë¡œ ë³€í™˜ (í—¤ë” í¬í•¨)
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { defval: '' });
                
                if (jsonData.length === 0) {
                    alert('ì—‘ì…€ íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                processFileData(gameId, jsonData);
            } catch (error) {
                console.error('ì—‘ì…€ íŒŒì¼ ì½ê¸° ì˜¤ë¥˜:', error);
                alert('ì—‘ì…€ íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
        
        // CSV íŒŒì¼ ì²˜ë¦¬ í•¨ìˆ˜
        function processCSVFile(gameId, text) {
            try {
                // UTF-8 BOM ì œê±°
                if (text.charCodeAt(0) === 0xFEFF) {
                    text = text.slice(1);
                }
                
                console.log(`CSV íŒŒì‹± ì‹œë„ (ê¸¸ì´: ${text.length})`);
                
                // Papa.parseë¡œ CSV íŒŒì‹±
                Papa.parse(text, {
                    header: true,
                    skipEmptyLines: true,
                    delimiter: '', // ìë™ ê°ì§€
                    newline: '', // ìë™ ê°ì§€
                    quoteChar: '"',
                    escapeChar: '"',
                    encoding: 'UTF-8',
                    transform: function(value) {
                        // ê°’ì´ ìˆëŠ” ê²½ìš° ê·¸ëŒ€ë¡œ ë°˜í™˜ (ì¸ì½”ë”© ë³´ì¡´)
                        if (value !== null && value !== undefined) {
                            return String(value);
                        }
                        return '';
                    },
                    complete: function(results) {
                        if (results.errors && results.errors.length > 0) {
                            console.warn('CSV íŒŒì‹± ê²½ê³ :', results.errors);
                            // ê²½ê³ ê°€ ë§ì•„ë„ ê³„ì† ì§„í–‰
                        }
                        
                        // ë°ì´í„° ê²€ì¦
                        if (results.data && results.data.length > 0) {
                            console.log(`CSV íŒŒì‹± ì„±ê³µ: ${results.data.length}ê°œ í–‰`);
                            console.log('ì»¬ëŸ¼ëª…:', Object.keys(results.data[0]));
                            console.log('ì²« ë²ˆì§¸ í–‰ ìƒ˜í”Œ:', results.data[0]);
                            
                            // ë¹ˆ í–‰ ì œê±°
                            const filteredData = results.data.filter(row => {
                                // ëª¨ë“  ê°’ì´ ë¹„ì–´ìˆì§€ ì•Šì€ í–‰ë§Œ ìœ ì§€
                                return Object.values(row).some(val => val !== null && val !== undefined && String(val).trim() !== '');
                            });
                            
                            console.log(`í•„í„°ë§ í›„: ${filteredData.length}ê°œ í–‰`);
                            
                            if (filteredData.length > 0) {
                                processFileData(gameId, filteredData);
                            } else {
                                alert('CSV íŒŒì¼ì— ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                            }
                        } else {
                            console.error('CSV íŒŒì‹± ê²°ê³¼: ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
                            alert('CSV íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ê±°ë‚˜ íŒŒì‹±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        }
                    },
                    error: function(error) {
                        console.error('CSV íŒŒì‹± ì˜¤ë¥˜:', error);
                        alert('CSV íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                    }
                });
            } catch (error) {
                console.error('CSV íŒŒì¼ ì½ê¸° ì˜¤ë¥˜:', error);
                alert('CSV íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // íŒŒì¼ ë°ì´í„° ì²˜ë¦¬ (ê³µí†µ í•¨ìˆ˜)
        function processFileData(gameId, data) {
            if (!data || data.length === 0) {
                alert('íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            console.log(`${gameId} íŒŒì¼ ì²˜ë¦¬ ì‹œì‘: ì´ ${data.length}ê°œ í–‰`);
            console.log('íŒŒì¼ ë°ì´í„° ìƒ˜í”Œ:', data[0]);
            console.log('ì»¬ëŸ¼ëª…:', Object.keys(data[0]));
            
            const headers = Object.keys(data[0]);
            
            // ëª¨ë“  ì»¬ëŸ¼ëª… ì¶œë ¥
            console.log('ì „ì²´ ì»¬ëŸ¼ ëª©ë¡:');
            headers.forEach((h, i) => {
                console.log(`  ${i}: ${h} = "${data[0] ? data[0][h] : ''}"`);
            });
            
            // ì»¬ëŸ¼ëª… ë§¤í•‘ (ì‹¤ì œ ì»¬ëŸ¼ëª… ì‚¬ìš©)
            // A=Id, B=UserKey, C=SessionKey, D=Language, E=QuestionType, F=Question, G=Answer, H=LlmAnswerType, I=IsContact, J=QuestionTime, K=AnswerTime
            let questionCol = headers.find(h => h && h.trim() === 'Question') || null; // Fì—´
            let answerCol = headers.find(h => h && h.trim() === 'Answer') || null; // Gì—´
            let dateCol = headers.find(h => h && h.trim() === 'AnswerTime') || null; // Kì—´
            
            // ëŒ€ì²´ ì»¬ëŸ¼ëª… ì°¾ê¸° (ëŒ€ì†Œë¬¸ì ë¬´ì‹œ)
            if (!questionCol) {
                questionCol = headers.find(h => {
                    if (!h) return false;
                    const hLower = h.toLowerCase().trim();
                    return hLower === 'question' || hLower.includes('question');
                }) || null;
            }
            
            if (!answerCol) {
                answerCol = headers.find(h => {
                    if (!h) return false;
                    const hLower = h.toLowerCase().trim();
                    return hLower === 'answer' || (hLower.includes('answer') && !hLower.includes('time'));
                }) || null;
            }
            
            if (!dateCol) {
                dateCol = headers.find(h => {
                    if (!h) return false;
                    const hLower = h.toLowerCase().trim();
                    return hLower === 'answertime' || hLower.includes('answertime');
                }) || null;
            }
            
            console.log('ë§¤í•‘ëœ ì»¬ëŸ¼:', { 
                questionCol, 
                answerCol, 
                dateCol, 
                questionValue: data[0] ? data[0][questionCol] : 'N/A',
                answerValue: data[0] ? data[0][answerCol] : 'N/A',
                dateValue: data[0] ? data[0][dateCol] : 'N/A'
            });
            
            // ë°ì´í„° ì •ê·œí™” ë° ì •ë‹µ ì—¬ë¶€ ì»¬ëŸ¼ ì¶”ê°€
            data.forEach((row, index) => {
                // ì§ˆë¬¸ê³¼ ë‹µë³€ ì»¬ëŸ¼ëª… ë§¤í•‘
                let questionValue = '';
                let answerValue = '';
                let dateValue = '';
                
                if (questionCol && row[questionCol] !== undefined && row[questionCol] !== null) {
                    questionValue = String(row[questionCol] || '').trim();
                } else {
                    // ëŒ€ì²´ ì»¬ëŸ¼ëª… ì‹œë„
                    questionValue = String(row['Question'] || row['ì§ˆë¬¸'] || row['question'] || '').trim();
                }
                
                if (answerCol && row[answerCol] !== undefined && row[answerCol] !== null) {
                    answerValue = String(row[answerCol] || '').trim();
                } else {
                    // ëŒ€ì²´ ì»¬ëŸ¼ëª… ì‹œë„
                    answerValue = String(row['Answer'] || row['ë‹µë³€'] || row['answer'] || '').trim();
                }
                
                if (dateCol && row[dateCol] !== undefined && row[dateCol] !== null) {
                    dateValue = String(row[dateCol] || '').trim();
                } else {
                    dateValue = String(row['AnswerTime'] || row['ë‹µë³€ì‹œê°„'] || row['answerTime'] || '').trim();
                }
                
                row['Question'] = questionValue;
                row['QuestionAnswer'] = answerValue;
                
                // ë‚ ì§œ íŒŒì‹± (Kì—´ AnswerTime)
                row['FormattedDate'] = formatDate(dateValue);
                row['AnswerTime'] = dateValue; // ì›ë³¸ ë‚ ì§œë„ ë³´ê´€
                
                // ë””ë²„ê¹…: ì²« ë²ˆì§¸ í–‰ë§Œ ë¡œê·¸ ì¶œë ¥
                if (index === 0) {
                    console.log('ì²« ë²ˆì§¸ í–‰ ë°ì´í„°:', {
                        questionCol,
                        answerCol,
                        dateCol,
                        question: row['Question'],
                        answer: row['QuestionAnswer'],
                        date: row['FormattedDate'],
                        rawRowKeys: Object.keys(row),
                        rawRow: row
                    });
                }
                
                // ì •ë‹µ ì—¬ë¶€ ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ ì¶”ê°€
                if (!row['ì •ë‹µì—¬ë¶€']) {
                    row['ì •ë‹µì—¬ë¶€'] = '';
                }
                // ë¶„ë¥˜ìœ í˜• ì»¬ëŸ¼ ì¶”ê°€ (ê¸°ì¡´ ì˜¤ë‹µìœ í˜•ê³¼ í˜¸í™˜)
                if (!row['ë¶„ë¥˜ìœ í˜•']) {
                    row['ë¶„ë¥˜ìœ í˜•'] = row['ì˜¤ë‹µìœ í˜•'] || '';
                }
                if (!row['ì˜¤ë‹µìœ í˜•']) {
                    row['ì˜¤ë‹µìœ í˜•'] = ''; // ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€
                }
                
                // IDëŠ” ì¸ë±ìŠ¤ ë²ˆí˜¸ ì‚¬ìš©
                row['Id'] = index + 1;
            });

            console.log(`${gameId} ë°ì´í„° ì €ì¥ ì™„ë£Œ: ${data.length}ê°œ í–‰`);
            gameData[gameId] = data;
            saveGameDataToStorage(gameId, data);
            displayGameData(gameId, data);
            updateDashboard();
        }

        // LocalStorageì— ê²Œì„ ë°ì´í„° ì €ì¥
        function saveGameDataToStorage(gameId, data) {
            try {
                const storageKey = `chatbot_error_analysis_${gameId}`;
                localStorage.setItem(storageKey, JSON.stringify(data));
                console.log(`${gameId} ë°ì´í„°ê°€ LocalStorageì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            } catch (error) {
                console.error('LocalStorage ì €ì¥ ì˜¤ë¥˜:', error);
                // LocalStorage ìš©ëŸ‰ ì´ˆê³¼ ì‹œ ê²½ê³ 
                if (error.name === 'QuotaExceededError') {
                    alert('ë°ì´í„°ê°€ ë„ˆë¬´ ì»¤ì„œ ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì¼ë¶€ ë°ì´í„°ë§Œ ì €ì¥ë©ë‹ˆë‹¤.');
                }
            }
        }

        // LocalStorageì—ì„œ ê²Œì„ ë°ì´í„° ë³µì›
        function loadGameDataFromStorage() {
            const gameIds = ['newmago', 'sutda', 'poker', 'newvegas', 'showdown', 'pc-integrated'];
            let hasData = false;

            gameIds.forEach(gameId => {
                try {
                    const storageKey = `chatbot_error_analysis_${gameId}`;
                    const savedData = localStorage.getItem(storageKey);
                    
                    if (savedData) {
                        const data = JSON.parse(savedData);
                        if (data && data.length > 0) {
                            gameData[gameId] = data;
                            displayGameData(gameId, data);
                            hasData = true;
                            console.log(`${gameId} ë°ì´í„°ê°€ LocalStorageì—ì„œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤. (${data.length}ê°œ í–‰)`);
                        }
                    }
                } catch (error) {
                    console.error(`${gameId} ë°ì´í„° ë³µì› ì˜¤ë¥˜:`, error);
                }
            });

            if (hasData) {
                updateDashboard();
            }
        }

        // LocalStorage ë°ì´í„° ì´ˆê¸°í™” (ì„ íƒì‚¬í•­)
        function clearAllStoredData() {
            if (confirm('ëª¨ë“  ì €ì¥ëœ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                const gameIds = ['newmago', 'sutda', 'poker', 'newvegas', 'showdown', 'pc-integrated'];
                gameIds.forEach(gameId => {
                    const storageKey = `chatbot_error_analysis_${gameId}`;
                    localStorage.removeItem(storageKey);
                    gameData[gameId] = null;
                });
                location.reload();
            }
        }

        // ë‚ ì§œ í˜•ì‹ ë³€í™˜: "2025. 11. 27. ì˜¤í›„ 10:03:36" -> "251127"
        function formatDate(dateStr) {
            if (!dateStr) return '';
            
            // "2025. 11. 27. ì˜¤í›„ 10:03:36" í˜•ì‹ íŒŒì‹±
            const match = dateStr.match(/(\d{4})\.\s*(\d{1,2})\.\s*(\d{1,2})/);
            if (match) {
                const year = match[1].substring(2); // 2025 -> 25
                const month = match[2].padStart(2, '0'); // 11 -> 11
                const day = match[3].padStart(2, '0'); // 27 -> 27
                return year + month + day; // 251127
            }
            
            // ë‹¤ë¥¸ í˜•ì‹ ì‹œë„
            const date = new Date(dateStr);
            if (!isNaN(date.getTime())) {
                const year = date.getFullYear().toString().substring(2);
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                const day = date.getDate().toString().padStart(2, '0');
                return year + month + day;
            }
            
            return dateStr; // íŒŒì‹± ì‹¤íŒ¨ ì‹œ ì›ë³¸ ë°˜í™˜
        }

        // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
        function escapeHtml(text) {
            if (!text) return '';
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return String(text).replace(/[&<>"']/g, function(m) { return map[m]; });
        }

        // ê²Œì„ë³„ ë°ì´í„° í‘œì‹œ
        function displayGameData(gameId, data) {
            const statsDiv = document.getElementById(`${gameId}-stats`);
            const tableContainer = document.getElementById(`${gameId}-table-container`);
            
            if (!statsDiv || !tableContainer) return;

            // í†µê³„ ê³„ì‚°
            const total = data.length;
            const errors = data.filter(row => row['ì •ë‹µì—¬ë¶€'] && row['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X').length;
            const errorRate = total > 0 ? ((errors / total) * 100).toFixed(2) : 0;

            // í†µê³„ í‘œì‹œ
            document.getElementById(`${gameId}-total`).textContent = total.toLocaleString();
            document.getElementById(`${gameId}-errors`).textContent = errors.toLocaleString();
            document.getElementById(`${gameId}-error-rate`).textContent = errorRate + '%';

            console.log(`${gameId} ë°ì´í„° í‘œì‹œ: ì´ ${total}ê°œ í–‰`);

            // í…Œì´ë¸” ìƒì„±
            let tableHTML = '<table class="data-table"><thead><tr>';
            tableHTML += '<th>ë²ˆí˜¸</th><th>ì§ˆë¬¸</th><th>ë‹µë³€</th><th>ì •ë‹µì—¬ë¶€</th><th>ë¶„ë¥˜ìœ í˜•</th><th>ë‚ ì§œ</th>';
            tableHTML += '</tr></thead><tbody>';

            data.forEach((row, index) => {
                const correctness = row['ì •ë‹µì—¬ë¶€'] || '';
                const categoryType = row['ë¶„ë¥˜ìœ í˜•'] || row['ì˜¤ë‹µìœ í˜•'] || ''; // ê¸°ì¡´ ë°ì´í„° í˜¸í™˜ì„±
                const isCorrect = correctness.toUpperCase() === 'O';
                const isError = correctness.toUpperCase() === 'X';
                const question = escapeHtml(row['Question'] || '');
                const answer = escapeHtml(row['QuestionAnswer'] || '');
                const formattedDate = escapeHtml(row['FormattedDate'] || '');

                tableHTML += '<tr>';
                tableHTML += `<td>${index + 1}</td>`;
                tableHTML += `<td style="max-width: 300px; word-wrap: break-word; white-space: normal; line-height: 1.5;">${question || '(ì§ˆë¬¸ ì—†ìŒ)'}</td>`;
                tableHTML += `<td style="max-width: 300px; word-wrap: break-word; white-space: normal; line-height: 1.5;">${answer || '(ë‹µë³€ ì—†ìŒ)'}</td>`;
                tableHTML += `<td>
                    <select class="error-type-select" onchange="updateCorrectness('${gameId}', ${index}, this.value, 'correctness')">
                        <option value="">ì„ íƒ</option>
                        <option value="O" ${correctness.toUpperCase() === 'O' ? 'selected' : ''}>O (ì •ë‹µ)</option>
                        <option value="X" ${correctness.toUpperCase() === 'X' ? 'selected' : ''}>X (ì˜¤ë‹µ)</option>
                    </select>
                </td>`;
                tableHTML += `<td>
                    <select class="error-type-select" onchange="updateCorrectness('${gameId}', ${index}, this.value, 'categoryType')" ${!correctness ? 'disabled' : ''}>
                        <option value="">ì„ íƒ</option>`;
                
                // ì •ë‹µì¼ ë•Œì˜ ìœ í˜•
                if (isCorrect || !correctness) {
                    tableHTML += `
                        <option value="ì •ìƒ ë‹µë³€" ${categoryType === 'ì •ìƒ ë‹µë³€' ? 'selected' : ''}>ì •ìƒ ë‹µë³€</option>
                        <option value="ë°ì´í„° ë¶€ì¡± (ì •ìƒ)" ${categoryType === 'ë°ì´í„° ë¶€ì¡± (ì •ìƒ)' ? 'selected' : ''}>ë°ì´í„° ë¶€ì¡± (ì •ìƒ)</option>
                        <option value="ê²Œì„ ì™¸ ì§ˆë¬¸ (ì •ìƒ)" ${categoryType === 'ê²Œì„ ì™¸ ì§ˆë¬¸ (ì •ìƒ)' ? 'selected' : ''}>ê²Œì„ ì™¸ ì§ˆë¬¸ (ì •ìƒ)</option>`;
                }
                
                // ì˜¤ë‹µì¼ ë•Œì˜ ìœ í˜•
                if (isError || !correctness) {
                    tableHTML += `
                        <option value="ì‚¬ì‹¤ ê´€ê³„ ì˜¤ë¥˜" ${categoryType === 'ì‚¬ì‹¤ ê´€ê³„ ì˜¤ë¥˜' ? 'selected' : ''}>ì‚¬ì‹¤ ê´€ê³„ ì˜¤ë¥˜</option>
                        <option value="ì˜ë„ íŒŒì•… ì‹¤íŒ¨" ${categoryType === 'ì˜ë„ íŒŒì•… ì‹¤íŒ¨' ? 'selected' : ''}>ì˜ë„ íŒŒì•… ì‹¤íŒ¨</option>
                        <option value="ë™ë¬¸ì„œë‹µ/TMI" ${categoryType === 'ë™ë¬¸ì„œë‹µ/TMI' ? 'selected' : ''}>ë™ë¬¸ì„œë‹µ/TMI</option>
                        <option value="ë‹µë³€ ë¶ˆì™„ì „" ${categoryType === 'ë‹µë³€ ë¶ˆì™„ì „' ? 'selected' : ''}>ë‹µë³€ ë¶ˆì™„ì „</option>
                        <option value="ê¸°íƒ€" ${categoryType === 'ê¸°íƒ€' ? 'selected' : ''}>ê¸°íƒ€</option>`;
                }
                
                tableHTML += `
                    </select>
                </td>`;
                tableHTML += `<td>${formattedDate}</td>`;
                tableHTML += '</tr>';
            });

            tableHTML += '</tbody></table>';
            tableContainer.innerHTML = tableHTML;
            statsDiv.style.display = 'block';
        }

        // ì •ë‹µ ì—¬ë¶€ ì—…ë°ì´íŠ¸
        function updateCorrectness(gameId, index, value, type) {
            if (!gameData[gameId]) return;

            if (type === 'correctness') {
                gameData[gameId][index]['ì •ë‹µì—¬ë¶€'] = value;
                
                // ì •ë‹µ ì—¬ë¶€ê°€ ë³€ê²½ë˜ë©´ ë¶„ë¥˜ ìœ í˜• ì´ˆê¸°í™” ë° ë“œë¡­ë‹¤ìš´ ì˜µì…˜ ì—…ë°ì´íŠ¸
                gameData[gameId][index]['ë¶„ë¥˜ìœ í˜•'] = '';
                
                // í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§í•˜ì—¬ ë“œë¡­ë‹¤ìš´ ì˜µì…˜ ì—…ë°ì´íŠ¸
                displayGameData(gameId, gameData[gameId]);
            } else if (type === 'categoryType') {
                gameData[gameId][index]['ë¶„ë¥˜ìœ í˜•'] = value;
                // ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•´ ì˜¤ë‹µìœ í˜•ë„ ì—…ë°ì´íŠ¸ (ì˜¤ë‹µì¼ ë•Œë§Œ)
                if (gameData[gameId][index]['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X') {
                    gameData[gameId][index]['ì˜¤ë‹µìœ í˜•'] = value;
                }
            }

            // LocalStorageì— ì €ì¥
            saveGameDataToStorage(gameId, gameData[gameId]);
            
            // í†µê³„ ì¬ê³„ì‚°
            displayGameData(gameId, gameData[gameId]);
            updateDashboard();
            
            // ì˜¤ë‹µ ìœ í˜•ë³„ í™•ë¥  í‘œì‹œ ì—…ë°ì´íŠ¸
            updateErrorTypeProbabilities(gameId);
        }

        // ì˜¤ë‹µ ìœ í˜•ë³„ í™•ë¥  ê³„ì‚° ë° í‘œì‹œ
        function updateErrorTypeProbabilities(gameId) {
            if (!gameData[gameId]) return;

            const data = gameData[gameId];
            const totalErrors = data.filter(row => row['ì •ë‹µì—¬ë¶€'] && row['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X').length;
            
            if (totalErrors === 0) return;

            const errorTypes = {
                'ì‚¬ì‹¤ ê´€ê³„ ì˜¤ë¥˜': 0,
                'ì˜ë„ íŒŒì•… ì‹¤íŒ¨': 0,
                'ë™ë¬¸ì„œë‹µ/TMI': 0,
                'ë‹µë³€ ë¶ˆì™„ì „': 0,
                'ê¸°íƒ€': 0
            };

            data.forEach(row => {
                if (row['ì •ë‹µì—¬ë¶€'] && row['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X') {
                    const categoryType = row['ë¶„ë¥˜ìœ í˜•'] || row['ì˜¤ë‹µìœ í˜•'] || '';
                    if (categoryType && errorTypes.hasOwnProperty(categoryType)) {
                        errorTypes[categoryType]++;
                    } else if (categoryType) {
                        errorTypes['ê¸°íƒ€']++;
                    }
                }
            });

            // ì˜¤ë‹µ ìœ í˜•ë³„ í™•ë¥  í‘œì‹œ (ê²Œì„ë³„ ì„¹ì…˜ì— ì¶”ê°€ ê°€ëŠ¥)
            console.log(`${gameId} ì˜¤ë‹µ ìœ í˜•ë³„ í™•ë¥ :`, Object.keys(errorTypes).map(type => ({
                type,
                count: errorTypes[type],
                probability: ((errorTypes[type] / totalErrors) * 100).toFixed(2) + '%'
            })));
        }

        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        function updateDashboard() {
            let totalQuestions = 0;
            let totalErrors = 0;
            const gameStats = {};

            Object.keys(gameData).forEach(gameId => {
                if (gameData[gameId]) {
                    const total = gameData[gameId].length;
                    const errors = gameData[gameId].filter(row => 
                        row['ì •ë‹µì—¬ë¶€'] && row['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X'
                    ).length;
                    
                    totalQuestions += total;
                    totalErrors += errors;
                    gameStats[gameId] = { total, errors };
                }
            });

            const overallErrorRate = totalQuestions > 0 ? ((totalErrors / totalQuestions) * 100).toFixed(2) : 0;

            document.getElementById('total-questions').textContent = totalQuestions.toLocaleString();
            document.getElementById('total-errors').textContent = totalErrors.toLocaleString();
            document.getElementById('overall-error-rate').textContent = overallErrorRate + '%';

            // ê²Œì„ë³„ í†µê³„ ì—…ë°ì´íŠ¸
            const gameNames = {
                'newmago': 'ë‰´ë§ê³ ',
                'sutda': 'ì„¯ë‹¤',
                'poker': 'í¬ì»¤',
                'newvegas': 'ë‰´ë² ê°€ìŠ¤',
                'showdown': 'ì‡¼ë‹¤ìš´í™€ë¤',
                'pc-integrated': 'PC í†µí•©'
            };

            Object.keys(gameStats).forEach(gameId => {
                const stats = gameStats[gameId];
                const errorRate = stats.total > 0 ? ((stats.errors / stats.total) * 100).toFixed(2) : '0.00';
                
                document.getElementById(`game-${gameId}-error-rate`).textContent = errorRate + '%';
                document.getElementById(`game-${gameId}-total`).textContent = stats.total.toLocaleString();
                document.getElementById(`game-${gameId}-errors`).textContent = stats.errors.toLocaleString();
            });

            // ë°ì´í„°ê°€ ì—†ëŠ” ê²Œì„ì€ '-' í‘œì‹œ
            Object.keys(gameData).forEach(gameId => {
                if (!gameStats[gameId]) {
                    document.getElementById(`game-${gameId}-error-rate`).textContent = '-';
                    document.getElementById(`game-${gameId}-total`).textContent = '-';
                    document.getElementById(`game-${gameId}-errors`).textContent = '-';
                }
            });

            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (ê°„ë‹¨í•œ ì˜ˆì‹œ)
            updateCharts(gameStats);
        }

        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateCharts(gameStats) {
            const gameNames = {
                'newmago': 'ë‰´ë§ê³ ',
                'sutda': 'ì„¯ë‹¤',
                'poker': 'í¬ì»¤',
                'newvegas': 'ë‰´ë² ê°€ìŠ¤',
                'showdown': 'ì‡¼ë‹¤ìš´í™€ë¤',
                'pc-integrated': 'PC í†µí•©'
            };

            // ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘
            let allData = [];
            Object.keys(gameData).forEach(gameId => {
                if (gameData[gameId]) {
                    gameData[gameId].forEach(row => {
                        // Questionê³¼ QuestionAnswer ì •ê·œí™”
                        const normalizedRow = {
                            ...row,
                            Question: row['Question'] || row['ì§ˆë¬¸'] || row['question'] || '',
                            QuestionAnswer: row['QuestionAnswer'] || row['ë‹µë³€'] || row['answer'] || row['Answer'] || '',
                            QuestionTime: row['QuestionTime'] || row['AnswerTime'] || row['ë‹µë³€ì‹œê°„'] || row['answerTime'] || '',
                            gameId: gameId,
                            gameName: gameNames[gameId] || gameId
                        };
                        allData.push(normalizedRow);
                    });
                }
            });

            // ì›”ë³„ ì˜¤ë‹µë¥  ì°¨íŠ¸
            updateMonthlyChart(allData);

            // ì˜¤ë‹µ ìœ í˜•ë³„ ë¶„í¬ ì°¨íŠ¸
            updateErrorTypeChart(allData);

            // ê²Œì„ë³„ ë¹„êµ ì°¨íŠ¸
            updateGameComparisonChart(gameStats, gameNames);

            // ì¼ìë³„ ì˜¤ë‹µë¥  ì°¨íŠ¸
            updateDailyChart(allData);
        }

        // ì¼ìë³„ ì˜¤ë‹µë¥  ì°¨íŠ¸
        function updateDailyChart(allData) {
            const ctx = document.getElementById('daily-chart');
            if (!ctx || allData.length === 0) return;

            // ë‚ ì§œë³„ë¡œ ê·¸ë£¹í™” (FormattedDate ìš°ì„  ì‚¬ìš©)
            const dailyStats = {};
            allData.forEach(row => {
                let date = row['FormattedDate'] || '';
                if (!date && row['AnswerTime']) {
                    // FormattedDateê°€ ì—†ìœ¼ë©´ AnswerTimeì—ì„œ ì¶”ì¶œ
                    date = formatDate(row['AnswerTime']);
                }
                if (!date) {
                    date = 'ë‚ ì§œ ì—†ìŒ';
                }
                
                if (!dailyStats[date]) {
                    dailyStats[date] = { total: 0, errors: 0 };
                }
                dailyStats[date].total++;
                if (row['ì •ë‹µì—¬ë¶€'] && row['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X') {
                    dailyStats[date].errors++;
                }
            });

            // ë‚ ì§œ ì •ë ¬ (YYMMDD í˜•ì‹ì´ë¯€ë¡œ ë¬¸ìì—´ ì •ë ¬ë¡œë„ ì‹œê°„ìˆœ ì •ë ¬ë¨)
            const dates = Object.keys(dailyStats).filter(d => d !== 'ë‚ ì§œ ì—†ìŒ').sort();
            if (dailyStats['ë‚ ì§œ ì—†ìŒ']) {
                dates.push('ë‚ ì§œ ì—†ìŒ'); // ë‚ ì§œ ì—†ìŒì€ ë§ˆì§€ë§‰ì—
            }
            
            // ë‚ ì§œ ë ˆì´ë¸” í¬ë§·íŒ… (YYMMDD -> YY/MM/DD)
            const formattedDates = dates.map(date => {
                if (date === 'ë‚ ì§œ ì—†ìŒ') return date;
                if (date.length >= 6) {
                    const year = date.substring(0, 2);
                    const month = date.substring(2, 4);
                    const day = date.substring(4, 6);
                    return `${year}/${month}/${day}`;
                }
                return date;
            });
            
            const errorRates = dates.map(date => {
                const stats = dailyStats[date];
                return parseFloat(stats.total > 0 ? ((stats.errors / stats.total) * 100).toFixed(2) : 0);
            });

            // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì°¨íŠ¸ ìƒì„± ì•ˆ í•¨
            if (dates.length === 0 || errorRates.length === 0) {
                if (window.dailyChart) {
                    window.dailyChart.destroy();
                    window.dailyChart = null;
                }
                return;
            }

            // yì¶• ë²”ìœ„ ë™ì  ê³„ì‚° (ìµœëŒ€ê°’ì˜ 1.5ë°° ë˜ëŠ” ìµœì†Œ 5% ë²”ìœ„)
            const maxRate = Math.max(...errorRates, 0);
            const minRate = Math.min(...errorRates.filter(r => r > 0), 0);
            const range = maxRate - minRate;
            let yMax = Math.max(maxRate * 1.5, 5); // ìµœì†Œ 5% ë²”ìœ„ ë³´ì¥
            if (maxRate > 0 && maxRate < 1) {
                yMax = Math.max(maxRate * 2, 1); // 1% ë¯¸ë§Œì¼ ë•ŒëŠ” 2ë°° ë˜ëŠ” ìµœì†Œ 1%
            }
            const yMin = Math.max(0, minRate - (range * 0.2)); // í•˜í•œì„ ì€ ìµœì†Œê°’ì˜ 20% ì—¬ìœ 

            // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
            if (window.dailyChart) {
                window.dailyChart.destroy();
                window.dailyChart = null;
            }
            // Chart.jsì˜ getChartë¡œë„ í™•ì¸
            const existingChart = Chart.getChart(ctx);
            if (existingChart) {
                existingChart.destroy();
            }

            const chartConfig = {
                type: 'line',
                data: {
                    labels: formattedDates,
                    datasets: [{
                        label: 'ì¼ìë³„ ì˜¤ë‹µë¥  (%)',
                        data: errorRates,
                        borderColor: 'rgba(102, 126, 234, 1)',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: yMin,
                            max: yMax,
                            ticks: {
                                callback: function(value) {
                                    return value.toFixed(2) + '%';
                                },
                                stepSize: yMax > 10 ? 5 : (yMax > 1 ? 0.5 : 0.1) // ë²”ìœ„ì— ë”°ë¼ ìŠ¤í… í¬ê¸° ì¡°ì •
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'ì˜¤ë‹µë¥ : ' + context.parsed.y.toFixed(2) + '%';
                                }
                            }
                        }
                    }
                }
            };
            
            // ChartDataLabels í”ŒëŸ¬ê·¸ì¸ì´ ë¡œë“œë˜ì–´ ìˆìœ¼ë©´ ì¶”ê°€
            if (typeof ChartDataLabels !== 'undefined') {
                chartConfig.plugins = [ChartDataLabels];
                chartConfig.options.plugins.datalabels = {
                    display: function(context) {
                        return context.parsed && context.parsed.y !== undefined && context.parsed.y > 0;
                    },
                    color: '#333',
                    font: {
                        weight: 'bold',
                        size: 10
                    },
                    formatter: function(value, context) {
                        if (value !== undefined && !isNaN(value)) {
                            return value.toFixed(2) + '%';
                        }
                        return '';
                    },
                    anchor: 'end',
                    align: 'top',
                    offset: 5
                };
            }
            
            try {
                window.dailyChart = new Chart(ctx, chartConfig);
            } catch (error) {
                console.error('ì¼ìë³„ ì°¨íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
            }
        }

        // YYMMDD í˜•ì‹ì„ "YYë…„ MMì›”" í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        function formatMonthLabel(dateStr) {
            if (!dateStr || dateStr.length < 6) return dateStr;
            
            // YYMMDD í˜•ì‹ íŒŒì‹± (ì˜ˆ: 251127 -> 25ë…„ 11ì›”)
            const year = dateStr.substring(0, 2);
            const month = dateStr.substring(2, 4);
            
            // ì›”ì´ 00ì´ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ì›ë³¸ ë°˜í™˜
            if (month === '00' || parseInt(month) < 1 || parseInt(month) > 12) {
                return dateStr;
            }
            
            return `${year}ë…„ ${parseInt(month)}ì›”`;
        }

        // ì›”ë³„ ì˜¤ë‹µë¥  ì°¨íŠ¸
        function updateMonthlyChart(allData) {
            const ctx = document.getElementById('monthly-chart');
            if (!ctx || allData.length === 0) return;

            // ì›”ë³„ë¡œ ê·¸ë£¹í™” (FormattedDate ì‚¬ìš©: YYMMDD í˜•ì‹)
            const monthlyStats = {};
            allData.forEach(row => {
                let dateStr = row['FormattedDate'] || '';
                if (!dateStr && row['AnswerTime']) {
                    dateStr = formatDate(row['AnswerTime']);
                }
                
                if (dateStr && dateStr.length >= 6) {
                    // YYMMDD í˜•ì‹ì—ì„œ YYMM ì¶”ì¶œ (ì˜ˆ: 251127 -> 2511)
                    const monthKey = dateStr.substring(0, 4); // YYMM
                    
                    if (!monthlyStats[monthKey]) {
                        monthlyStats[monthKey] = { total: 0, errors: 0 };
                    }
                    monthlyStats[monthKey].total++;
                    if (row['ì •ë‹µì—¬ë¶€'] && row['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X') {
                        monthlyStats[monthKey].errors++;
                    }
                }
            });

            // ì›” í‚¤ë¥¼ ì •ë ¬ (YYMM í˜•ì‹ì´ë¯€ë¡œ ë¬¸ìì—´ ì •ë ¬ë¡œë„ ì‹œê°„ìˆœ ì •ë ¬ë¨)
            const monthKeys = Object.keys(monthlyStats).sort();
            const months = monthKeys.map(key => formatMonthLabel(key + '01')); // YYMM -> YYMMDDë¡œ ë³€í™˜í•˜ì—¬ í¬ë§·íŒ…
            const errorRates = monthKeys.map(key => {
                const stats = monthlyStats[key];
                return parseFloat(stats.total > 0 ? ((stats.errors / stats.total) * 100).toFixed(2) : 0);
            });

            // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì°¨íŠ¸ ìƒì„± ì•ˆ í•¨
            if (monthKeys.length === 0 || errorRates.length === 0) {
                if (window.monthlyChart) {
                    window.monthlyChart.destroy();
                    window.monthlyChart = null;
                }
                return;
            }

            // yì¶• ë²”ìœ„ ë™ì  ê³„ì‚° (ìµœëŒ€ê°’ì˜ 1.5ë°° ë˜ëŠ” ìµœì†Œ 5% ë²”ìœ„)
            const maxRate = Math.max(...errorRates, 0);
            const minRate = Math.min(...errorRates.filter(r => r > 0), 0);
            const range = maxRate - minRate;
            let yMax = Math.max(maxRate * 1.5, 5); // ìµœì†Œ 5% ë²”ìœ„ ë³´ì¥
            if (maxRate > 0 && maxRate < 1) {
                yMax = Math.max(maxRate * 2, 1); // 1% ë¯¸ë§Œì¼ ë•ŒëŠ” 2ë°° ë˜ëŠ” ìµœì†Œ 1%
            }
            const yMin = Math.max(0, minRate - (range * 0.2)); // í•˜í•œì„ ì€ ìµœì†Œê°’ì˜ 20% ì—¬ìœ 

            // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
            if (window.monthlyChart) {
                window.monthlyChart.destroy();
                window.monthlyChart = null;
            }
            // Chart.jsì˜ getChartë¡œë„ í™•ì¸
            const existingChart = Chart.getChart(ctx);
            if (existingChart) {
                existingChart.destroy();
            }

            const chartConfig = {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'ì›”ë³„ ì˜¤ë‹µë¥  (%)',
                        data: errorRates,
                        backgroundColor: 'rgba(118, 75, 162, 0.6)',
                        borderColor: 'rgba(118, 75, 162, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: yMin,
                            max: yMax,
                            ticks: {
                                callback: function(value) {
                                    return value.toFixed(2) + '%';
                                },
                                stepSize: yMax > 10 ? 5 : (yMax > 1 ? 0.5 : 0.1) // ë²”ìœ„ì— ë”°ë¼ ìŠ¤í… í¬ê¸° ì¡°ì •
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'ì˜¤ë‹µë¥ : ' + context.parsed.y.toFixed(2) + '%';
                                }
                            }
                        }
                    }
                }
            };
            
            // ChartDataLabels í”ŒëŸ¬ê·¸ì¸ì´ ë¡œë“œë˜ì–´ ìˆìœ¼ë©´ ì¶”ê°€
            if (typeof ChartDataLabels !== 'undefined') {
                chartConfig.plugins = [ChartDataLabels];
                chartConfig.options.plugins.datalabels = {
                    display: function(context) {
                        return context.parsed && context.parsed.y !== undefined && context.parsed.y > 0;
                    },
                    color: '#333',
                    font: {
                        weight: 'bold',
                        size: 10
                    },
                    formatter: function(value, context) {
                        if (value !== undefined && !isNaN(value)) {
                            return value.toFixed(2) + '%';
                        }
                        return '';
                    },
                    anchor: 'end',
                    align: 'top',
                    offset: 5
                };
            }
            
            try {
                window.monthlyChart = new Chart(ctx, chartConfig);
            } catch (error) {
                console.error('ì›”ë³„ ì°¨íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
            }
        }

        // ê²Œì„ë³„ ë¹„êµ ì°¨íŠ¸
        function updateGameComparisonChart(gameStats, gameNames) {
            const ctx = document.getElementById('game-comparison-chart');
            if (!ctx) return;

            const labels = [];
            const errorRates = [];
            const gameStatsArray = []; // ê±´ìˆ˜ ì •ë³´ë¥¼ ì €ì¥í•  ë°°ì—´

            Object.keys(gameStats).forEach(gameId => {
                if (gameStats[gameId].total > 0) { // ë°ì´í„°ê°€ ìˆëŠ” ê²Œì„ë§Œ í‘œì‹œ
                    labels.push(gameNames[gameId] || gameId);
                    const rate = ((gameStats[gameId].errors / gameStats[gameId].total) * 100).toFixed(2);
                    errorRates.push(parseFloat(rate));
                    // ê±´ìˆ˜ ì •ë³´ ì €ì¥ (ì˜¤ë‹µ ìˆ˜ / ì „ì²´ ìˆ˜)
                    gameStatsArray.push({
                        errors: gameStats[gameId].errors,
                        total: gameStats[gameId].total
                    });
                }
            });

            if (labels.length === 0) return; // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì°¨íŠ¸ ìƒì„± ì•ˆ í•¨

            // yì¶• ë²”ìœ„ ë™ì  ê³„ì‚°
            const maxRate = Math.max(...errorRates, 0);
            const minRate = Math.min(...errorRates.filter(r => r > 0), 0);
            let yMax = Math.max(maxRate * 1.5, 5); // ìµœì†Œ 5% ë²”ìœ„ ë³´ì¥
            if (maxRate > 0 && maxRate < 1) {
                yMax = Math.max(maxRate * 2, 1); // 1% ë¯¸ë§Œì¼ ë•ŒëŠ” 2ë°° ë˜ëŠ” ìµœì†Œ 1%
            }
            const yMin = Math.max(0, minRate - ((maxRate - minRate) * 0.2));

            // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
            if (window.gameComparisonChart) {
                window.gameComparisonChart.destroy();
                window.gameComparisonChart = null;
            }
            // Chart.jsì˜ getChartë¡œë„ í™•ì¸
            const existingChart = Chart.getChart(ctx);
            if (existingChart) {
                existingChart.destroy();
            }

            const chartConfig = {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ì˜¤ë‹µë¥  (%)',
                        data: errorRates,
                        backgroundColor: 'rgba(102, 126, 234, 0.6)',
                        borderColor: 'rgba(102, 126, 234, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: yMin,
                            max: yMax,
                            ticks: {
                                callback: function(value) {
                                    return value.toFixed(2) + '%';
                                },
                                stepSize: yMax > 10 ? 5 : (yMax > 1 ? 0.5 : 0.1) // ë²”ìœ„ì— ë”°ë¼ ìŠ¤í… í¬ê¸° ì¡°ì •
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const index = context.dataIndex;
                                    const stats = gameStatsArray[index];
                                    if (stats) {
                                        return 'ì˜¤ë‹µë¥ : ' + context.parsed.y.toFixed(2) + '% (' + stats.errors + '/' + stats.total + 'ê±´)';
                                    }
                                    return 'ì˜¤ë‹µë¥ : ' + context.parsed.y.toFixed(2) + '%';
                                }
                            }
                        }
                    }
                }
            };
            
            // ChartDataLabels í”ŒëŸ¬ê·¸ì¸ì´ ë¡œë“œë˜ì–´ ìˆìœ¼ë©´ ì¶”ê°€
            if (typeof ChartDataLabels !== 'undefined') {
                chartConfig.plugins = [ChartDataLabels];
                chartConfig.options.plugins.datalabels = {
                    display: function(context) {
                        return context.parsed && context.parsed.y !== undefined && context.parsed.y > 0;
                    },
                    color: '#333',
                    font: {
                        weight: 'bold',
                        size: 10
                    },
                    formatter: function(value, context) {
                        if (value !== undefined && !isNaN(value)) {
                            const index = context.dataIndex;
                            const stats = gameStatsArray[index];
                            if (stats) {
                                // í¼ì„¼íŠ¸ì™€ ê±´ìˆ˜ í•¨ê»˜ í‘œì‹œ
                                return value.toFixed(2) + '%\n(' + stats.errors + '/' + stats.total + ')';
                            }
                            return value.toFixed(2) + '%';
                        }
                        return '';
                    },
                    anchor: 'end',
                    align: 'top',
                    offset: 5
                };
            }
            
            try {
                window.gameComparisonChart = new Chart(ctx, chartConfig);
            } catch (error) {
                console.error('ê²Œì„ë³„ ë¹„êµ ì°¨íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
            }
        }

        // ì˜¤ë‹µ ìœ í˜•ë³„ ë¶„í¬ ì°¨íŠ¸
        function updateErrorTypeChart(allData) {
            const ctx = document.getElementById('error-type-chart');
            if (!ctx || allData.length === 0) return;

            const errorTypeCounts = {
                'ì‚¬ì‹¤ ê´€ê³„ ì˜¤ë¥˜': 0,
                'ì˜ë„ íŒŒì•… ì‹¤íŒ¨': 0,
                'ë™ë¬¸ì„œë‹µ/TMI': 0,
                'ë‹µë³€ ë¶ˆì™„ì „': 0,
                'ê¸°íƒ€': 0
            };

            allData.forEach(row => {
                if (row['ì •ë‹µì—¬ë¶€'] && row['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X') {
                    const categoryType = row['ë¶„ë¥˜ìœ í˜•'] || row['ì˜¤ë‹µìœ í˜•'] || '';
                    if (categoryType && errorTypeCounts.hasOwnProperty(categoryType)) {
                        errorTypeCounts[categoryType]++;
                    } else if (categoryType) {
                        errorTypeCounts['ê¸°íƒ€']++;
                    }
                }
            });

            const totalErrors = Object.values(errorTypeCounts).reduce((a, b) => a + b, 0);
            if (totalErrors === 0) return;

            if (window.errorTypeChart) {
                window.errorTypeChart.destroy();
            }

            const labels = Object.keys(errorTypeCounts);
            const values = Object.values(errorTypeCounts);
            
            // ìƒ‰ìƒ ë°°ì—´ í™•ì¥ (5ê°œ í•­ëª©ì— ë§ì¶¤)
            const backgroundColors = [
                'rgba(102, 126, 234, 0.8)',
                'rgba(118, 75, 162, 0.8)',
                'rgba(255, 159, 64, 0.8)',
                'rgba(75, 192, 192, 0.8)',
                'rgba(255, 99, 132, 0.8)'
            ];
            const borderColors = [
                'rgba(102, 126, 234, 1)',
                'rgba(118, 75, 162, 1)',
                'rgba(255, 159, 64, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(255, 99, 132, 1)'
            ];

            const chartConfig = {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: backgroundColors.slice(0, labels.length),
                        borderColor: borderColors.slice(0, labels.length),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const percentage = totalErrors > 0 ? ((value / totalErrors) * 100).toFixed(1) : 0;
                                    return label + ': ' + value + 'ê±´ (' + percentage + '%)';
                                }
                            }
                        },
                        datalabels: {
                            display: function(context) {
                                // ê°’ì´ 0ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ í‘œì‹œ
                                return context.dataset.data[context.dataIndex] > 0;
                            },
                            color: '#333',
                            font: {
                                weight: 'bold',
                                size: 11
                            },
                            formatter: function(value, context) {
                                const label = context.chart.data.labels[context.dataIndex];
                                const percentage = totalErrors > 0 ? ((value / totalErrors) * 100).toFixed(1) : 0;
                                return label + '\n' + value + 'ê±´\n(' + percentage + '%)';
                            },
                            textAlign: 'center',
                            padding: 4
                        }
                    }
                }
            };
            
            // ChartDataLabels í”ŒëŸ¬ê·¸ì¸ì´ ë¡œë“œë˜ì–´ ìˆìœ¼ë©´ ì¶”ê°€
            if (typeof ChartDataLabels !== 'undefined') {
                chartConfig.plugins = [ChartDataLabels];
            }
            
            try {
                window.errorTypeChart = new Chart(ctx, chartConfig);
            } catch (error) {
                console.error('ì˜¤ë‹µ ìœ í˜•ë³„ ë¶„í¬ ì°¨íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
            }
        }

        // ê²Œì„ë³„ ì˜¤ë‹µ í•­ëª© í‘œì‹œ
        function showErrorItems(gameId, gameName) {
            if (!gameData[gameId] || gameData[gameId].length === 0) {
                alert('í•´ë‹¹ ê²Œì„ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ì˜¤ë‹µ í•­ëª© í•„í„°ë§
            const errorItems = gameData[gameId].filter(row => 
                row['ì •ë‹µì—¬ë¶€'] && row['ì •ë‹µì—¬ë¶€'].toUpperCase() === 'X'
            );

            if (errorItems.length === 0) {
                alert('ì˜¤ë‹µ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ëª¨ë‹¬ ì œëª© ì„¤ì •
            document.getElementById('modal-game-name').textContent = `${gameName} ì˜¤ë‹µ í•­ëª© (${errorItems.length}ê±´)`;

            // ì˜¤ë‹µ í•­ëª© ë¦¬ìŠ¤íŠ¸ ìƒì„±
            const listContainer = document.getElementById('error-items-list');
            listContainer.innerHTML = '';

            errorItems.forEach((item, index) => {
                const question = item['Question'] || item['ì§ˆë¬¸'] || item['question'] || '(ì§ˆë¬¸ ì—†ìŒ)';
                const answer = item['QuestionAnswer'] || item['ë‹µë³€'] || item['answer'] || item['Answer'] || '(ë‹µë³€ ì—†ìŒ)';
                const categoryType = item['ë¶„ë¥˜ìœ í˜•'] || item['ì˜¤ë‹µìœ í˜•'] || 'ë¯¸ë¶„ë¥˜';
                const formattedDate = item['FormattedDate'] || '';
                
                // ë‚ ì§œ í¬ë§·íŒ…
                let dateDisplay = '';
                if (formattedDate && formattedDate.length >= 6) {
                    const year = formattedDate.substring(0, 2);
                    const month = formattedDate.substring(2, 4);
                    const day = formattedDate.substring(4, 6);
                    dateDisplay = `${year}/${month}/${day}`;
                }

                const itemCard = document.createElement('div');
                itemCard.className = 'error-item-card';
                itemCard.innerHTML = `
                    <div class="error-item-header">
                        <span class="error-item-number">#${index + 1}</span>
                        <span class="error-item-category">${categoryType}</span>
                    </div>
                    <div class="error-item-question">${question}</div>
                    <div class="error-item-answer">${answer}</div>
                    ${dateDisplay ? `<div class="error-item-date">ğŸ“… ${dateDisplay}</div>` : ''}
                `;
                listContainer.appendChild(itemCard);
            });

            // ëª¨ë‹¬ í‘œì‹œ
            const modal = document.getElementById('error-items-modal');
            modal.style.display = 'block';
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeErrorItemsModal() {
            const modal = document.getElementById('error-items-modal');
            modal.style.display = 'none';
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        window.onclick = function(event) {
            const modal = document.getElementById('error-items-modal');
            if (event.target === modal) {
                closeErrorItemsModal();
            }
        }

        // GitHubì—ì„œ CSV íŒŒì¼ ìë™ ë¡œë“œ (ì„ íƒì‚¬í•­)
        async function loadCSVFromGitHub(gameId, csvPath) {
            try {
                const response = await fetch(csvPath);
                if (!response.ok) {
                    console.log(`CSV íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${csvPath}`);
                    return false;
                }
                const text = await response.text();
                
                // UTF-8 BOM ì œê±°
                if (text.charCodeAt(0) === 0xFEFF) {
                    text = text.slice(1);
                }
                
                // Papa.parseë¡œ CSV íŒŒì‹± (ê°œì„ ëœ ì˜µì…˜)
                Papa.parse(text, {
                    header: true,
                    skipEmptyLines: true,
                    encoding: 'UTF-8',
                    delimiter: '', // ìë™ ê°ì§€
                    newline: '', // ìë™ ê°ì§€
                    quoteChar: '"',
                    escapeChar: '"',
                    transform: function(value) {
                        // ë¹ˆ ê°’ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ trim (ê³µë°±ë§Œ ìˆëŠ” ê²½ìš°ë„ ìœ ì§€)
                        if (value && typeof value === 'string') {
                            return value;
                        }
                        return value || '';
                    },
                    complete: function(results) {
                        if (results.errors && results.errors.length > 0) {
                            console.warn(`${gameId} CSV íŒŒì‹± ê²½ê³ :`, results.errors);
                        }
                        if (results.data && results.data.length > 0) {
                            console.log(`${gameId} CSV íŒŒì‹± ì„±ê³µ: ${results.data.length}ê°œ í–‰`);
                            console.log(`${gameId} ì²« ë²ˆì§¸ í–‰:`, results.data[0]);
                            console.log(`${gameId} ì»¬ëŸ¼ëª…:`, Object.keys(results.data[0]));
                            processFileData(gameId, results.data);
                            console.log(`${gameId} CSV íŒŒì¼ ë¡œë“œ ì™„ë£Œ: ${results.data.length}ê°œ í–‰`);
                        } else {
                            console.error(`${gameId} CSV íŒŒì‹± ê²°ê³¼: ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤`);
                        }
                    },
                    error: function(error) {
                        console.log(`${gameId} CSV íŒŒì‹± ì˜¤ë¥˜:`, error);
                    }
                });
                
                return true;
            } catch (error) {
                console.log(`CSV ë¡œë“œ ì‹¤íŒ¨ (${gameId}):`, error);
                return false;
            }
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // LocalStorageì—ì„œ ë°ì´í„° ë³µì›
            loadGameDataFromStorage();
            
            // GitHub Pagesì—ì„œ CSV íŒŒì¼ ìë™ ë¡œë“œ ì‹œë„ (ì„ íƒì‚¬í•­)
            // CSV íŒŒì¼ëª… ë§¤í•‘ (gameId -> ì‹¤ì œ íŒŒì¼ëª…)
            const csvFileMapping = {
                'newmago': 'newmatgo.csv',
                'sutda': 'sudda.csv',
                'poker': 'poker.csv',
                'newvegas': 'newvegas.csv',
                'showdown': 'holdem.csv',
                'pc-integrated': 'pc.csv'
            };
            
            const gameIds = ['newmago', 'sutda', 'poker', 'newvegas', 'showdown', 'pc-integrated'];
            const basePath = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/')) || '';
            
            // GitHub Pages í™˜ê²½ì´ë©´ í•­ìƒ CSV íŒŒì¼ ë¡œë“œ ì‹œë„ (LocalStorageë³´ë‹¤ ìš°ì„ )
            if (window.location.hostname === 'github.io' || window.location.hostname.includes('github')) {
                console.log('GitHub Pages í™˜ê²½ì—ì„œ CSV íŒŒì¼ ìë™ ë¡œë“œ ì‹œë„...');
                
                // LocalStorage ë°ì´í„° ê²€ì¦ (ì§ˆë¬¸/ë‹µë³€ì´ ìˆëŠ”ì§€ í™•ì¸)
                let hasValidData = false;
                Object.keys(gameData).forEach(gameId => {
                    if (gameData[gameId] && gameData[gameId].length > 0) {
                        // ì²« ë²ˆì§¸ í–‰ì— ì§ˆë¬¸ì´ë‚˜ ë‹µë³€ì´ ìˆëŠ”ì§€ í™•ì¸
                        const firstRow = gameData[gameId][0];
                        const hasQuestion = firstRow['Question'] && firstRow['Question'].trim() !== '';
                        const hasAnswer = firstRow['QuestionAnswer'] && firstRow['QuestionAnswer'].trim() !== '';
                        if (!hasQuestion && !hasAnswer) {
                            console.log(`${gameId}: LocalStorage ë°ì´í„°ì— ì§ˆë¬¸/ë‹µë³€ì´ ì—†ì–´ì„œ CSV ì¬ë¡œë“œ`);
                            gameData[gameId] = null; // ì˜ëª»ëœ ë°ì´í„° ì œê±°
                        } else {
                            hasValidData = true;
                        }
                    }
                });
                
                // ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ê±°ë‚˜, GitHub Pages í™˜ê²½ì´ë©´ CSV ë¡œë“œ
                if (!hasValidData) {
                    gameIds.forEach(gameId => {
                        const csvFileName = csvFileMapping[gameId] || `${gameId}.csv`;
                        // CSV íŒŒì¼ì´ index.htmlê³¼ ê°™ì€ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ìˆìŒ
                        const csvPath = `${basePath}/${csvFileName}`;
                        console.log(`CSV ë¡œë“œ ì‹œë„: ${csvPath}`);
                        loadCSVFromGitHub(gameId, csvPath);
                    });
                }
            }
            
            // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ (ë°ì´í„° ë³µì› í›„ ìë™ìœ¼ë¡œ í˜¸ì¶œë˜ì§€ë§Œ ì•ˆì „ì„ ìœ„í•´)
            // CSV ë¡œë“œ ëŒ€ê¸° ì‹œê°„ì„ ëŠ˜ë¦¼ (GitHub Pagesì—ì„œ íŒŒì¼ ë¡œë“œ ì‹œê°„ ê³ ë ¤)
            setTimeout(() => {
                updateDashboard();
            }, 2000); // CSV ë¡œë“œ ëŒ€ê¸° ì‹œê°„ (2ì´ˆ)

            // ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
            const closeBtn = document.querySelector('.modal-close');
            if (closeBtn) {
                closeBtn.addEventListener('click', closeErrorItemsModal);
            }
        });
    </script>
</body>
</html>
